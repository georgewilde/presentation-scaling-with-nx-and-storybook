<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Clever code scaling with Nx and Storybook</title>
        <meta
            name="description"
            content="Presentation on how Purplebricks scales the frontend code using Nx and Storybook."
        />
        <meta name="author" content="George Wilde" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta
            name="apple-mobile-web-app-status-bar-style"
            content="black-translucent"
        />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="reveal.js/dist/reset.css" />
        <link rel="stylesheet" href="reveal.js/dist/reveal.css" />
        <link rel="stylesheet" href="styles/bootstrap/bootstrap.min.css" />
        <link rel="stylesheet" href="styles/theme/light.css" id="theme" />
        <link rel="stylesheet" href="styles/layout.css" />

        <!-- Theme used for syntax highlighting of code -->
        <link
            rel="stylesheet"
            href="reveal.js/plugin/highlight/monokai.css"
            id="highlight-theme"
        />
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section>
                    <a href="https://www.purplebricks.co.uk/">
                        <img
                            src="https://pbonlineassets.azureedge.net/web-images/marketing-global/logos/pb-logo-dark.svg"
                            alt="Purplebricks logo"
                            style="
                                height: 180px;
                                margin: 0 auto 4rem auto;
                                background: transparent;
                            "
                            class="demo-logo"
                        />
                    </a>
                    <h3>Clever code scaling with<br />Nx and Storybook</h3>
                </section>
                <section>
                    <h2>About me</h2>
                    <img
                        src="images/profile.jpg"
                        alt="Picture of me"
                        class="profile-photo"
                    />
                    <p>
                        <a href="https://www.linkedin.com/in/george-wilde/">
                            George Wilde
                        </a>
                    </p>
                    <p>Senior front-end engineer at Purplebricks</p>
                </section>
                <section>
                    <h2>We have a problem</h2>
                    <img
                        src="images/initial-frontend-architecture.png"
                        alt="Initial front-end architecture"
                        style="height: 200px"
                        class="mt-4"
                    />
                    <aside class="notes">
                        <p>We've got a code problem.</p>
                        <ul>
                            <li>
                                Successful company built up over 6 years. In
                                that time, different engineers have come and
                                gone and contributed to our codebase.
                            </li>
                            <li>
                                We've added new features and products and piled
                                code on top of code without much consideration
                                of governance and the future maintainability.
                            </li>
                            <li>
                                We were a startup. We needed to get a product
                                out the door and prove we had a product that
                                people wanted.
                            </li>
                            <li>
                                So now we’re a scale-up and we’ve been
                                struggling. We can continue to deliver at speed,
                                but only if we cut corners but the user and
                                developer experience is going to get worse each
                                time we do.
                            </li>
                            <li>
                                So what is the debt that we've collected? - Talk
                                through diagram
                            </li>
                            <li>
                                Realising we don't want to live in this kind of
                                a world, we decided it was time to pay the debt
                                down.
                            </li>
                        </ul>
                    </aside>
                </section>
                <section>
                    <h2>The main issues</h2>
                    <ul>
                        <li>Code duplication</li>
                        <li>
                            Different versions of things used by other things
                        </li>
                        <li>Code in multiple repositories</li>
                        <li>Different technologies</li>
                    </ul>
                    <aside class="notes">
                        <p>We identified where the pain points are:</p>
                    </aside>
                </section>
                <section>
                    <h2>What are we doing about it?</h2>
                    <img
                        src="images/nx-logo.png"
                        alt="Nx logo"
                        class="fragment"
                        style="height: 300px"
                    />
                    <aside class="notes">
                        <p>
                            We suspected that if we could pull the code for all
                            our products into one place and have it managed in
                            one way we could alleviate a lot of these issues.
                        </p>
                        <p>
                            We reviewed some tools that are designed to help
                            with this kind of thing and decided to experiment
                            with Nx.
                        </p>
                    </aside>
                </section>
                <section>
                    <h2>What is Nx?</h2>
                    <q
                        >Nx is a set of extensible dev tools for mono-repos,
                        which helps you develop like Google, Facebook, and
                        Microsoft.</q
                    >
                    <ul class="list-unstyled mt-4">
                        <li class="fragment">
                            <img
                                src="images/checked.svg"
                                alt="Tick"
                                style="height: 30px; margin: 0 25px"
                            />Open-source
                        </li>
                        <li class="fragment">
                            <img
                                src="images/checked.svg"
                                alt="Tick"
                                style="height: 30px; margin: 0 25px"
                            />Free
                        </li>
                        <li class="fragment">
                            <img
                                src="images/checked.svg"
                                alt="Tick"
                                style="height: 30px; margin: 0 25px"
                            />Ex-Angular developers and Google tech leads
                        </li>
                    </ul>
                    <aside class="notes">
                        <p>Sounds good</p>
                        <p>It’s open-source</p>
                        <p>free</p>
                        <p>
                            and the team that builds and maintains it are
                            ex-core Angular developers and Google tech leads.
                        </p>
                    </aside>
                </section>
                <section>
                    <h2>What does Nx give us?</h2>
                    <ul class="list-unstyled mt-4">
                        <li class="fragment">
                            <img
                                src="images/checked.svg"
                                alt="Tick"
                                style="height: 30px; margin: 0 25px"
                            />Mono-repo
                        </li>
                        <li class="fragment">
                            <img
                                src="images/checked.svg"
                                alt="Tick"
                                style="height: 30px; margin: 0 25px"
                            />Libraries and applications
                        </li>
                        <li class="fragment">
                            <img
                                src="images/checked.svg"
                                alt="Tick"
                                style="height: 30px; margin: 0 25px"
                            />CLI
                        </li>
                        <li class="fragment">
                            <img
                                src="images/checked.svg"
                                alt="Tick"
                                style="height: 30px; margin: 0 25px"
                            />No versioning
                        </li>
                    </ul>
                    <aside class="notes">
                        <p>
                            It gives us a single repository in which we can
                            store our applications.
                        </p>
                        <p>
                            It has a concept of libraries where we can pull out
                            all our shared code.
                        </p>
                        <p>
                            It also gives us a nice CLI that wraps around
                            everything and provides a consistent toolkit of
                            commands we can use to build, test and lint whatever
                            we want.
                        </p>
                        <p>
                            We spent a year using Yarn workspaces with Lerna and
                            with those tools, when you make a change, you
                            publish a new version that can then be consumed.
                            This leads to fragmentation as older applications
                            are not updated to use the latest versions and
                            you’re left supporting multiple versions of a
                            package. With Nx’s approach, when you change a
                            shared library you are forced to ensure it works
                            everywhere right there and then, you cannot leave
                            something on an older version and deal with it
                            later.
                        </p>
                    </aside>
                </section>
                <section>
                    <img
                        src="images/nx-plus-storybook.png"
                        alt="Nx plus Storybook = awesomeness"
                        style="height: 200px"
                    />
                    <aside class="notes">
                        <p>
                            Once we could see how our applications would sit
                            next to each other and how we could utilise
                            libraries, we realised there would be a lot of power
                            in moving all our React components that could be
                            used in more than one application into a library and
                            use Nx’s support for Storybook to create a design
                            guide we could to use to build, test and make
                            visible the UI building blocks available.
                        </p>
                    </aside>
                </section>
                <section>
                    <h2>What does all this look like?</h2>
                    <img
                        src="images/nx-architecture.png"
                        alt="Nx architecture"
                        class="fragment"
                        style="height: 500px"
                    />
                </section>
                <section>
                    <h2>What is the workflow like?</h2>
                    <aside class="notes">
                        <p>
                            Let’s say we’re creating a new micro-frontend
                            application. Obviously we follow the usual planning
                            and refinement, but when we know what we want to
                            build, we use the Nx CLI to generate a new
                            application in our mono-repo. We actually have our
                            own second CLI command that tidies up the default Nx
                            application template to fit some specific
                            requirements we have. We are then able to deploy the
                            “Hello world” application out to QA and production.
                            In total that’s about an hours work.
                        </p>
                        <p>
                            We can then start to pull in the shared components
                            from the library, creating each of the routes
                            required. The real effort is now all focussed on the
                            real domain logic stuff. All the setup, UI, config,
                            deployment stuff is just there, fully tested and
                            ready to use.
                        </p>
                        <p>
                            If we identify any components that we don’t already
                            have, we build them inside the specific application.
                            They can always be pulled out into the shared
                            component library if we want to use it in another
                            application in the future.
                        </p>
                    </aside>
                </section>
                <section>
                    <h2>What are the benefits?</h2>
                    <ul>
                        <li class="fragment">
                            Cleaner codebase with reduced duplication
                        </li>
                        <li class="fragment">
                            UI consistency across our products
                        </li>
                        <li class="fragment">Code consistency</li>
                        <li class="fragment">Tooling is faster</li>
                        <li class="fragment">Deployment pipeline is simpler</li>
                    </ul>
                    <aside class="notes">
                        <p>It’s still early days.</p>
                        <p>
                            we’ve built 3 new applications and are moving 1
                            existing application.
                        </p>
                        <p>
                            Although the majority of our code is still outside
                            of Nx we’re already seeing how this structure leads
                            to some significant improvements for us.
                        </p>
                        <ul>
                            <li>
                                Moved all duplication into libraries - no
                                versioning
                            </li>
                            <li>Storybook helps with this</li>
                            <li>
                                With one set of linting rules for everything
                            </li>
                            <li>
                                Nx using caching to help tests, linting and
                                building run quickly
                            </li>
                            <li>CLI helps with deployment</li>
                        </ul>
                    </aside>
                </section>
                <section>
                    <h2>Resources</h2>
                    <ul>
                        <li>
                            This presentation:
                            <a href="https://bit.ly/3kK2alb"
                                >https://bit.ly/3kK2alb</a
                            >
                        </li>
                        <li>Nx: <a href="https://nx.dev">https://nx.dev</a></li>
                        <li>
                            Storybook:
                            <a href="https://storybook.js.org"
                                >https://storybook.js.org</a
                            >
                        </li>
                        <li>
                            Purplebricks:
                            <a href="https://www.purplebricks.co.uk"
                                >https://www.purplebricks.co.uk</a
                            >
                        </li>
                    </ul>
                </section>
                <section>
                    <h2>Thank you</h2>
                    <img
                        src="https://media.giphy.com/media/XHVmD4RyXgSjd8aUMb/giphy.gif"
                        alt="Questions?"
                    />
                </section>
            </div>
        </div>

        <script src="reveal.js/dist/reveal.js"></script>
        <script src="reveal.js/plugin/zoom/zoom.js"></script>
        <script src="reveal.js/plugin/notes/notes.js"></script>
        <script src="reveal.js/plugin/search/search.js"></script>
        <script src="reveal.js/plugin/markdown/markdown.js"></script>
        <script src="reveal.js/plugin/highlight/highlight.js"></script>
        <script>
            Reveal.initialize({
                controls: true,
                progress: true,
                center: true,
                hash: true,
                plugins: [
                    RevealZoom,
                    RevealNotes,
                    RevealSearch,
                    RevealMarkdown,
                    RevealHighlight,
                ],
            });
            Reveal.configure({ pdfSeparateFragments: false });
        </script>
    </body>
</html>
